/* ============================================
   ДОПОЛНИТЕЛЬНАЯ МОБИЛЬНАЯ ОПТИМИЗАЦИЯ
   Расширенные стили для улучшения UX на мобильных устройствах
   ============================================ */

/* Touch-friendly стили */
@media (max-width: 768px) {
  * {
    -webkit-tap-highlight-color: rgba(27, 67, 50, 0.1);
    -webkit-touch-callout: none;
  }

  a,
  button,
  input,
  select,
  textarea {
    -webkit-tap-highlight-color: rgba(27, 67, 50, 0.2);
  }

  /* Увеличение кликабельных зон для доступности */
  button,
  .btn,
  a.btn {
    min-height: 44px;
    min-width: 44px;
  }

  input[type="checkbox"] {
    min-width: 20px;
    min-height: 20px;
  }

  /* Анимация бургер-меню */
  .mobile-menu-toggle[aria-expanded="true"] span:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }

  .mobile-menu-toggle[aria-expanded="true"] span:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-toggle[aria-expanded="true"] span:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }

  /* Затемнение фона при открытом меню */
  .nav-menu.active::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    z-index: -1;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  /* Оптимизация производительности */
  .product-card,
  .category-card,
  .brand-card {
    will-change: transform;
  }

  img {
    will-change: auto;
  }
}

/* Оптимизация для средних мобильных устройств */
@media (max-width: 640px) {
  /* Формы и инпуты - предотвращает зум на iOS */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  textarea,
  select {
    font-size: 16px !important;
    padding: var(--space-3) var(--space-4) !important;
  }

  textarea {
    min-height: 120px !important;
  }

  /* Галерея изображений */
  .image-gallery {
    gap: var(--space-2) !important;
  }

  .main-image-wrapper,
  .gallery-main {
    height: 280px !important;
    border-radius: var(--radius-lg) !important;
  }

  .thumbnail {
    width: 60px !important;
    height: 60px !important;
  }

  .zoom-hint {
    font-size: 11px !important;
    padding: var(--space-2) var(--space-3) !important;
  }

  .zoom-hint svg {
    width: 16px !important;
    height: 16px !important;
  }

  /* Fullscreen галерея на мобильных */
  .fullscreen-overlay {
    padding: 0 !important;
  }

  .fullscreen-image {
    max-width: 100% !important;
    max-height: 80vh !important;
    object-fit: contain !important;
  }

  .fullscreen-close {
    top: var(--space-3) !important;
    right: var(--space-3) !important;
    width: 40px !important;
    height: 40px !important;
  }

  .nav-arrow {
    width: 40px !important;
    height: 40px !important;
  }

  .nav-arrow.left {
    left: var(--space-2) !important;
  }

  .nav-arrow.right {
    right: var(--space-2) !important;
  }
}

/* Очень маленькие экраны */
@media (max-width: 380px) {
  .product-info {
    padding: var(--space-2) !important;
  }

  .product-name {
    font-size: 12px !important;
  }

  .product-price {
    font-size: 13px !important;
  }

  .btn-view {
    width: 28px !important;
    height: 28px !important;
  }

  /* Мобильные фильтры - дополнительные улучшения */
  .filters-column {
    overscroll-behavior: contain;
  }

  .mobile-filter-btn {
    -webkit-user-select: none;
    user-select: none;
  }

  /* Предотвращение скролла body при открытых фильтрах */
  body:has(.filters-column.show-mobile) {
    overflow: hidden;
  }
}

/* Улучшения для списков в фильтрах */
@media (max-width: 768px) {
  .brands-list,
  .tags-list,
  .categories-list {
    max-height: 200px;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .brand-item,
  .tag-item,
  .category-item {
    min-height: 44px;
    display: flex;
    align-items: center;
    padding: 12px;
    margin-bottom: 4px;
    border-radius: var(--radius-md);
    transition: background-color 0.2s ease;
  }

  .brand-item:active,
  .tag-item:active,
  .category-item:active {
    background-color: var(--gray-100);
  }
}
